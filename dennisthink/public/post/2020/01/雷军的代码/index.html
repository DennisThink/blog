<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>雷军的代码 - 浮生笔记</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="DennisThink" />
  <meta name="description" content="“开放源代码” 我还与冯志宏合作开发过一个共享软件RI（RAMinit，清内存的小工具）。 当时RI很流行。之所以能够流行，是因为当时电脑的内存" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.109.0" />


<link rel="canonical" href="https://www.dennisthink.com/post/2020/01/%E9%9B%B7%E5%86%9B%E7%9A%84%E4%BB%A3%E7%A0%81/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.de22abc00de44766eebd1054fd9e0b254b071f89d5019044f893c484a9249a8d.css" integrity="sha256-3iKrwA3kR2buvRBU/Z4LJUsHH4nVAZBE&#43;JPEhKkkmo0=" media="screen" crossorigin="anonymous">







<meta property="og:title" content="雷军的代码" />
<meta property="og:description" content="“开放源代码” 我还与冯志宏合作开发过一个共享软件RI（RAMinit，清内存的小工具）。 当时RI很流行。之所以能够流行，是因为当时电脑的内存" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.dennisthink.com/post/2020/01/%E9%9B%B7%E5%86%9B%E7%9A%84%E4%BB%A3%E7%A0%81/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-01-20T21:38:52+08:00" />
<meta property="article:modified_time" content="2019-01-28T21:41:52+08:00" />
<meta itemprop="name" content="雷军的代码">
<meta itemprop="description" content="“开放源代码” 我还与冯志宏合作开发过一个共享软件RI（RAMinit，清内存的小工具）。 当时RI很流行。之所以能够流行，是因为当时电脑的内存"><meta itemprop="datePublished" content="2019-01-20T21:38:52+08:00" />
<meta itemprop="dateModified" content="2019-01-28T21:41:52+08:00" />
<meta itemprop="wordCount" content="6068">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="雷军的代码"/>
<meta name="twitter:description" content="“开放源代码” 我还与冯志宏合作开发过一个共享软件RI（RAMinit，清内存的小工具）。 当时RI很流行。之所以能够流行，是因为当时电脑的内存"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">浮生笔记</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/">关于</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      浮生笔记
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.dennisthink.com/">关于</a>
          

        

      </li>
    

    
    

    <li class="menu-item">
      <a class="menu-item-link">
        <form action="/search" method="GET">
          <input type="search" name="s" id="search-query" placeholder="">
          <button type="submit">查找</button>
        </form>
      </a>
    </li>

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight wallpaper">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">雷军的代码</h1>
      

      <div class="post-meta">
  <div class="post-meta-author">
    by
      <a href="/about">
        <span class="post-meta-author-name">
          DennisThink
        </span>
      </a>
    
  </div>

  <div class="post-meta-time">
    <time datetime="2019-01-20">
      2019-01-20
    </time>
  </div>

  
    <div class="post-meta-lastmod">
      (上次更新:
      2019-01-28)
    </div>
  


  <div class="post-meta__right">
    

    


    
    


    
    
  </div>
</div>

    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents"></nav>
  </div>
</div>


    
    <div class="post-content">
      <blockquote>
<p>“开放源代码”</p>
<p>我还与冯志宏合作开发过一个共享软件RI（RAMinit，清内存的小工具）。
当时RI很流行。之所以能够流行，是因为当时电脑的内存很小，在运行程序多了之后会导致系统速度变得很慢，而有些软件则可能因为内存被其他资&gt;   源占用而无法运行，这时候就需要重启电脑。RI执行以后驻留内存，然后随时可以通过可自定义的热键（默认同时按下左Ctrl和右Ctrl）来清除当&gt;   前的环境或正在执行中的程序，回到驻留RI时的DOS提示符状态下。为了让更多的用户免收频繁重启的痛苦，我决定把这款工具软件完全免费。
这个产品对于程序员调试程序非常方便。开发软件的过程中，总存在很多死机的 bug, 需要频繁重启电脑。使用RI可以提高程序员的效率。很快，&gt;   RI在当时程序员也几乎是人手一份的必备工具。
1992年底，我花了整整三天时间重写了RI，新版的RI 2.0功能更为强劲。为了让更多的程序员来帮我修改完善，我公布了所有的源代码。
看来RI也算国内最早一批开放源代码的免费软件了。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; RI.ASM  Revision 2.12         [ July 12, 1994 ]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Revision</span>        <span style="color:#66d9ef">equ</span>     <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">V2.12</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; **************************************************************************
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *                                                                        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *  RAMinit  Release 2.0                                                  *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *  Copyright (c) 1989-1994 by Yellow Rose Software Co.                   *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *  Written by Mr. Leijun                                                 *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *                                                                        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *  Function:                                                             *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *    Press HotKey to remove all TSR program after this program           *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; *                                                                        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; **************************************************************************
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ..........................................................................
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; Removed Softwares by RI:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   SPDOS v6.0F, WPS v3.0F
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Game Busters III, IV
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   NETX ( Novell 3.11 )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   PC-CACHE
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Norton Cache
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Microsoft SmartDrv
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   SideKick 1.56A
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   MOUSE Driver
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Crazy (Monochrome simulate CGA program)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   RAMBIOS v2.0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   386MAX Version 6.01
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; ..........................................................................
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; No cancel softwares:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Windows 3.1 MSD
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; No removed TSR softwares:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   MS-DOS fastopen
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Buffers, Files ... (QEMM 6.0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   QCache (386MAX 6.01)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; ..........................................................................
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">COMMENT</span> *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">V2.04</span>  <span style="color:#66d9ef">Use</span> <span style="color:#66d9ef">mouse</span> <span style="color:#66d9ef">driver</span> <span style="color:#66d9ef">software</span> <span style="color:#66d9ef">reset</span> <span style="color:#66d9ef">function</span> <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">initiation</span> <span style="color:#66d9ef">mouse</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">2/17/1993</span> <span style="color:#a6e22e">by</span>  <span style="color:#66d9ef">Mr.</span> <span style="color:#66d9ef">Lei</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">Mr.</span> <span style="color:#66d9ef">Feng</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">V2.05</span>  <span style="color:#66d9ef">RI</span> <span style="color:#66d9ef">cannot</span> <span style="color:#66d9ef">work</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">DOS</span> <span style="color:#66d9ef">prompt</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">3/9/1993</span>  <span style="color:#a6e22e">by</span> <span style="color:#66d9ef">Mr.</span> <span style="color:#66d9ef">Lei</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">V2.06</span>  <span style="color:#ae81ff">1</span>. <span style="color:#66d9ef">When</span> <span style="color:#66d9ef">XMS</span> <span style="color:#66d9ef">cannot</span> <span style="color:#66d9ef">allocate</span> <span style="color:#ae81ff">1</span><span style="color:#66d9ef">K</span> <span style="color:#66d9ef">memory</span>, <span style="color:#66d9ef">RI</span> <span style="color:#66d9ef">halts.</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">2.</span> <span style="color:#a6e22e">RI</span> <span style="color:#66d9ef">repeat</span> <span style="color:#66d9ef">deallocates</span> <span style="color:#66d9ef">EMS</span> <span style="color:#66d9ef">memory.</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">V2.07</span>  <span style="color:#66d9ef">HotKey</span> <span style="color:#66d9ef">Setup</span> <span style="color:#66d9ef">Error</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">4/25/1993</span> <span style="color:#a6e22e">by</span> <span style="color:#66d9ef">Mr.</span> <span style="color:#66d9ef">Lei</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">V2.08</span>  <span style="color:#66d9ef">KB</span> <span style="color:#66d9ef">Buffer</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">V2.10</span>  <span style="color:#ae81ff">1</span>. <span style="color:#66d9ef">Release</span> <span style="color:#66d9ef">high</span> <span style="color:#66d9ef">memory</span> <span style="color:#66d9ef">blocks</span> (<span style="color:#66d9ef">EMM386</span> <span style="color:#66d9ef">QEMM386</span> <span style="color:#66d9ef">S-ICE</span> <span style="color:#ae81ff">386</span><span style="color:#66d9ef">MAX</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">2.</span> <span style="color:#a6e22e">RI</span> <span style="color:#66d9ef">copies</span> <span style="color:#66d9ef">flag</span>
</span></span><span style="display:flex;"><span> <span style="color:#a6e22e">V2.12</span>  <span style="color:#ae81ff">1</span>. <span style="color:#66d9ef">Exists</span> <span style="color:#66d9ef">a</span> <span style="color:#66d9ef">critical</span> <span style="color:#66d9ef">error</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">Init</span> <span style="color:#ae81ff">8259</span> <span style="color:#66d9ef">procedure</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">2.</span> <span style="color:#a6e22e">Save</span> [<span style="color:#ae81ff">40</span>:<span style="color:#66d9ef">F0--FF</span>] <span style="color:#66d9ef">user</span> <span style="color:#66d9ef">data</span> <span style="color:#66d9ef">area</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">dosseg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">.model</span> <span style="color:#66d9ef">tiny</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">.code</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">locals</span>  <span style="color:#960050;background-color:#1e0010">@@</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">org</span>     <span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Start:          <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">Main</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">org</span>     <span style="color:#ae81ff">103</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">True</span>          <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">False</span>         <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">MaxHandles</span>    <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">INT3</span>    <span style="color:#66d9ef">macro</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ffh</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">endm</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;             HotKey Status                             Test Var
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;            ---------------                         ---------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;  7 6 5 4 3 2 1 0                                    417  418  496
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;  . . x . x . . .    Left Alt is pressed              8    2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;  x . . . x . . .    Right Alt is pressed             8         8
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;  . . . x . x . .    Left Ctrl is pressed             4    1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;  . x . . . x . .    Right Ctrl is pressed            4         4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;  . . . . . . x .    Left Shift is pressed            2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;  . . . . . . . x    Right Shift is pressed           1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">LeftAlt</span>       <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">00101000</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">RightAlt</span>      <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">10001000</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">LeftCtrl</span>      <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">00010100</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">RightCtrl</span>     <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">01000100</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">LeftShift</span>     <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">00000010</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">RightShift</span>    <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">00000001</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">HotKey</span>        <span style="color:#66d9ef">db</span>      <span style="color:#66d9ef">LeftCtrl</span> <span style="color:#66d9ef">or</span> <span style="color:#66d9ef">RightCtrl</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DataBegin</span>     <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">NextDataSeg</span>   <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ffffh</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">oldInt2F_addr</span> <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">XMS_control</span>   <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Handle_begin</span>  <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cvtOfs</span>        <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>       <span style="color:#75715e">; DOS 3.0 equ 0 and above DOS 4.0 is 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">org</span>     <span style="color:#ae81ff">104</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">db</span>      <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">db</span>      <span style="color:#66d9ef">Revision</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">db</span>      <span style="color:#960050;background-color:#1e0010">??</span><span style="color:#66d9ef">date</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">db</span>      <span style="color:#ae81ff">26</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">org</span>     <span style="color:#ae81ff">114</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tsrLength</span>     <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">MachineID</span>     <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">0</span><span style="color:#66d9ef">FCh</span>    <span style="color:#75715e">; IBM PC/AT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">AuxHotKey</span>     <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">0</span>       <span style="color:#75715e">; 2Dh     ; &#39;X&#39; Scan Code
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">AuxHotKeyName</span> <span style="color:#66d9ef">db</span>      <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">X$</span>      <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Power</span>         <span style="color:#66d9ef">db</span>      <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Flag</span>          <span style="color:#66d9ef">db</span>      <span style="color:#960050;background-color:#1e0010">&#39;</span>!<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Kbd102</span>        <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">NoFlag</span>        <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">StopFlag</span>      <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DosEnv</span>        <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">WorkSeg</span>       <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">PrevDataSeg</span>   <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Copies</span>        <span style="color:#66d9ef">db</span>      <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">old_8259</span>      <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">0</span>       <span style="color:#75715e">; 21h port
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">db</span>      <span style="color:#ae81ff">0</span>       <span style="color:#75715e">; a1h port
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">Status</span>        <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">XMSbit</span>        <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">00000001</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">EMSbit</span>        <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">00000010</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">SKbit</span>         <span style="color:#66d9ef">equ</span>     <span style="color:#ae81ff">10000000</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GoINT1C:        <span style="color:#a6e22e">db</span>      <span style="color:#ae81ff">0</span><span style="color:#66d9ef">eah</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">oldInt1C_addr</span> <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>newINT1C:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Status</span>, <span style="color:#66d9ef">SKbit</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#66d9ef">GoINT1C</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">StopFlag</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; Mr. Lei  2/8/1993
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; Problem: if WPS quit and reenter, old RI cann&#39;t control keyboard.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">9</span>*<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">NewInt9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#66d9ef">GoINT1C</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">StopFlag</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">9</span>*<span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">101</span><span style="color:#66d9ef">h</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">IE</span><span style="color:#960050;background-color:#1e0010">&#39;</span>        <span style="color:#75715e">; &#39;LEI&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cli</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">StopFlag</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">9</span>*<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldINT9_addr2</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">9</span>*<span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldINT9_addr2</span>[<span style="color:#ae81ff">2</span>], <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">9</span>*<span style="color:#ae81ff">4</span>], <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">newINT9_2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">9</span>*<span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>], <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sti</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">GoINT1C</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;  INT2F Func
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;     AX = C0D7h   Return RI segment in AX
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;     AX = C0D8h   Removes all TSR programs after RI
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;     AX = C0D9h   Removes all TSR programs include RI
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;     AX = C0DAh   Removes all RI copies
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; ----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>newINT2F:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span>      <span style="color:#75715e">; LEI Hanzi GB Code
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">iret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">KeepSelf</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">NoKeepSelf</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@3:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">NextDataSeg</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Copies</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">NoKeepSelf</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>    <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldInt2F_addr</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CallInt9:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>newINT9_2:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">NoFlag</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pushf</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">db</span>      <span style="color:#ae81ff">9</span><span style="color:#66d9ef">ah</span>             <span style="color:#75715e">; call far ptr oldint9_addr
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">oldInt9_Addr2</span> <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">newINT9_proc</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>newINT9:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pushf</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">db</span>      <span style="color:#ae81ff">9</span><span style="color:#66d9ef">ah</span>             <span style="color:#75715e">; call far ptr oldint9_addr
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">oldInt9_Addr</span>  <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">NoFlag</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#66d9ef">newINT9_proc</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">NoFlag</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">iret</span>
</span></span><span style="display:flex;"><span>newINT9_proc:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Flag</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span>!<span style="color:#960050;background-color:#1e0010">&#39;</span>    <span style="color:#75715e">; busy ?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">iret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Flag</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span>!<span style="color:#960050;background-color:#1e0010">&#39;</span>    <span style="color:#75715e">; set busy flag
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>              <span style="color:#75715e">; cmp hot key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">1</span><span style="color:#66d9ef">ah</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">1</span><span style="color:#66d9ef">ch</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_1:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>,<span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>]     <span style="color:#75715e">; test CTRL SHIFT ALT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">HotKey</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">f0fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Kbd102</span>, <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">18</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">303</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">96</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">303</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">eh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jb</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">eh</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_2:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">1</span><span style="color:#66d9ef">ah</span>], <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_3:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">IsWinDos</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Beep</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sti</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Flag</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>    <span style="color:#75715e">; no busy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">iret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>                                            <span style="color:#75715e">; OK
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>KeepSelf:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RemoveTSR</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>,<span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">WorkSeg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>,<span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">tsrLength</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>,<span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">h</span>           <span style="color:#75715e">; Aug 24, 1993
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>,<span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">stosb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">27</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NoKeepSelf:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">e07h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">clsStr</span>, <span style="color:#ae81ff">47</span><span style="color:#66d9ef">h</span>  <span style="color:#75715e">; Color (White in Red)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RemoveTSR</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">dec</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Copies</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreSelfIntVec</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">PrevDataSeg</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">PrevDataSeg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">NextDataSeg</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">c00h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>IsWinDOS:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">1600</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">01</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ffh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>                     <span style="color:#75715e">; Windows/386 Version 2.X
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">00</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">80</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>                     <span style="color:#75715e">; Windows 3 in enhanced mode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                                                <span style="color:#75715e">; Version number in AL/AH
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4680</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">80</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>   <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreSelfIntVec:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">Copies</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cli</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">oldInt9_Addr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">9</span>*<span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">oldInt2F_Addr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">2</span><span style="color:#66d9ef">Fh</span>*<span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">oldInt1C_Addr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">Ch</span>*<span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sti</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ------------- KERNEL PROGRAM ----------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RemoveTSR:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cli</span>                     <span style="color:#75715e">; Set stack
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">sp</span>, <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ss</span>, <span style="color:#66d9ef">sp</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">sp</span>, <span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sti</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Power</span>, <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Init8259</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_0:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#66d9ef">ds</span>:<span style="color:#66d9ef">NextDataSeg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">PrevDataSeg</span>, <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_1:   <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>,<span style="color:#66d9ef">ds</span>:<span style="color:#66d9ef">DataBegin</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">WorkSeg</span>, <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">XX</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Beep</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_2:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreEnvStr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreMCB</span>         <span style="color:#75715e">; restore current mcb
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">CloseFiles</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestorePort</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreLEDs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreVecList</span>     <span style="color:#75715e">; Restore vectors list
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreFloppyParam</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Power</span>, <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreCVTchain</span>    <span style="color:#75715e">; Restore cvt chain
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreMemoryManager</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreBiosData</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Enable8259</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">16</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">RestoreClockSpeed</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">CloseSpeaker</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ResetDisk</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">UpdateTime</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ClosePRN</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>,<span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">WorkSeg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">50</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>                <span style="color:#75715e">; Set PSP segment
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>                <span style="color:#75715e">; Set display mode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">InitPRN</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">InitMouse</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Copies</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ja</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_sh1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">ShowCopies</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span>*<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_sh2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_sh1: <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">ShowCopies</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_sh2:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">clsStr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ColorPrintStr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Flag</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>       <span style="color:#75715e">; no busy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">Copies</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_end</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">StopFlag</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_end:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ClearKB_buffer</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Beep:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">e07h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; #########################################################################
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>ClearKB_Buffer:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">0040</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cli</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">1</span><span style="color:#66d9ef">ah</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">1</span><span style="color:#66d9ef">ch</span>], <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sti</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Init8259:
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       cmp     cs:Copies, &#39;1&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">;       jz      @@1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">;       ret
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">MachineID</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">fch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ja</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">pc_xt</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>AT:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>,<span style="color:#ae81ff">870</span><span style="color:#66d9ef">h</span>         <span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">0</span>            <span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">F1h</span>,<span style="color:#66d9ef">al</span>         <span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">11</span><span style="color:#66d9ef">h</span>          <span style="color:#75715e">; ICW1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">A0h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">20</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">bl</span>           <span style="color:#75715e">; ICW2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">A1h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">bh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">2</span>            <span style="color:#75715e">; ICW3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">A1h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">1</span>            <span style="color:#75715e">; ICW4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">A1h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">FFh</span>         <span style="color:#75715e">; OCW1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">A1h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>PC_XT:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">13</span><span style="color:#66d9ef">h</span>          <span style="color:#75715e">; ICW1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">20</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">8</span>            <span style="color:#75715e">; ICW2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">9</span>            <span style="color:#75715e">; ICW4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">FFh</span>         <span style="color:#75715e">; OCW1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Enable8259:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">old_8259</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">021</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a1h</span>,<span style="color:#66d9ef">al</span>         <span style="color:#75715e">; DEC PC Bus Mouse
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">ret</span>                     <span style="color:#75715e">; July 1994 by Mr. Lei
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>RestoreBiosData:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span>--<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Beep</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a8h</span>         <span style="color:#75715e">; [40h:a8h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">49</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsb</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">f0h</span>         <span style="color:#75715e">; User data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>RestoreMCB:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>                           <span style="color:#75715e">; &#39;MZ&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">MM</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">di</span>,<span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">8</span>], <span style="color:#ae81ff">0</span>      <span style="color:#75715e">; Aug 24, 1993
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>   <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">0</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Z</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>CloseFiles:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">5</span>           <span style="color:#75715e">; Begin handle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">15</span>          <span style="color:#75715e">; Max handle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">sub</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">eh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestorePort:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>            <span style="color:#75715e">; restore port
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreLEDs:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">11110000</span><span style="color:#66d9ef">b</span>      <span style="color:#75715e">; LED status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">00001111</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ah</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">f0h</span>           <span style="color:#75715e">; Clear CTRL ALT SHIFT
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>], <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreEnvStr:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">DosEnv</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si</span>], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">stosb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">stosb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreVecList:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>,<span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">EL</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">I</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sub</span>     <span style="color:#66d9ef">cl</span>, <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cl</span>, <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di-4</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di-2</span>]
</span></span><span style="display:flex;"><span>         <span style="color:#960050;background-color:#1e0010">@@</span>a:   <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">a</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreFloppyParam:                                     <span style="color:#75715e">; Mr. Lei   2/10/1992
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">525</span><span style="color:#66d9ef">h</span>], <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreCVTchain:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">VC</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Beep</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_0:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; -----------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">lodsw</span>                   <span style="color:#75715e">; DPB
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">cvtOfs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">les</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">di</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; -----------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">lodsw</span>                   <span style="color:#75715e">; DCB
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">dec</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; -----------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">lodsw</span>                   <span style="color:#75715e">; Device Driver Chain
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cl</span>, <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">les</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreMemoryManager:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Status</span>, <span style="color:#66d9ef">XMSbit</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">LoadXMSstatus</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Status</span>, <span style="color:#66d9ef">EMSbit</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">LoadEMSstatus</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LoadEMSstatus:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">ME</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Beep</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_0:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_1:   <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>__0:  <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">45</span><span style="color:#66d9ef">h</span>         <span style="color:#75715e">; Deallocate Handle and Memory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">67</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ah</span>, <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">__1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">__0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>__1:  <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jb</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shl</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shl</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LoadXMSstatus:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">MX</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">Beep</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_0:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jcxz</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>                 <span style="color:#75715e">; free
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">bl</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">abh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>                 <span style="color:#75715e">; unlock
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@4:</span>    <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@5:</span>    <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">endp</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>CloseSpeaker:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">in</span>      <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">61</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">fch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">61</span><span style="color:#66d9ef">h</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>RestoreClockSpeed:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">00110110</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">43</span><span style="color:#66d9ef">h</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ResetDisk:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">13</span><span style="color:#66d9ef">h</span>             <span style="color:#75715e">; Restore A
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">13</span><span style="color:#66d9ef">h</span>             <span style="color:#75715e">; Restore B
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dl</span>, <span style="color:#ae81ff">80</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">13</span><span style="color:#66d9ef">h</span>             <span style="color:#75715e">; Restore C
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; --------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ClosePRN:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">51</span><span style="color:#66d9ef">h</span>         <span style="color:#75715e">; Get PSP seg
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">16</span><span style="color:#66d9ef">h</span>]    <span style="color:#75715e">; Prev PSP seg
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">e00h</span>       <span style="color:#75715e">; COMMAND
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>InitPRN:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">e00h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">4</span>           <span style="color:#75715e">; PRN
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">d01h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">PRNname</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PRNname</span>         <span style="color:#66d9ef">db</span>      <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">PRN</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>InitMouse:                              <span style="color:#75715e">; 2/16/1993 by Mr. Lei
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">33</span><span style="color:#66d9ef">h</span>*<span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">33</span><span style="color:#66d9ef">h</span>*<span style="color:#ae81ff">4</span>], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">33</span><span style="color:#66d9ef">h</span>             <span style="color:#75715e">; Hook Mouse Interrupt
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ------------- CMOS CLOCK set to System -----------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>UpdateTime:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">GetRealTime</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">2</span><span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GetRealTime:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">1</span><span style="color:#66d9ef">Ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">ch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">bcdxchg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ch</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">cl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">bcdxchg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cl</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">bcdxchg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dh</span>,<span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dl</span>,<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BCDxchg:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cl</span>,<span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">cl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bl</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">Ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mul</span>     <span style="color:#66d9ef">bl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">bl</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">Fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">bl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; Display string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ColorPrintStr:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bh</span>, <span style="color:#66d9ef">al</span>          <span style="color:#75715e">; color
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">014</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0600</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">02</span>          <span style="color:#75715e">; GotoXY (0, 0)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bh</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>PrintStr:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">eh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">short</span> <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">clsStrcolor</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">clsStr</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">Self</span>          <span style="color:#66d9ef">dw</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">clsStrcolor</span>   <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">clsStr</span>        <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>             <span style="color:#75715e">; Color (White in Blue)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">db</span> <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#66d9ef">RAMinit</span>  <span style="color:#66d9ef">Version</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">.12</span>  (<span style="color:#66d9ef">c</span>) <span style="color:#ae81ff">1989</span>-<span style="color:#ae81ff">1994</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">KingSoft</span> <span style="color:#66d9ef">Ltd.</span>  <span style="color:#66d9ef">Mr.</span> <span style="color:#66d9ef">Leijun</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">db</span> <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">db</span> <span style="color:#960050;background-color:#1e0010">&#39;</span> [<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ShowCopies</span>    <span style="color:#66d9ef">db</span>      <span style="color:#960050;background-color:#1e0010">&#39;</span>*<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">db</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>] <span style="color:#66d9ef">Activate...</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">endTSR</span>  <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">$</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">mcbList</span> <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">endTSR</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">2</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">vecList</span> <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">mcbList</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">7</span>*<span style="color:#ae81ff">10</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">2</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">1</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">400</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">devLink</span> <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">vecList</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">5</span> * <span style="color:#ae81ff">26</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">10</span> * <span style="color:#ae81ff">30</span><span style="color:#66d9ef">h</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xmsList</span> <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">devLink</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">2</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">MaxHandles</span> * <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">emsList</span> <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">xmsList</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">1024</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">crtMode</span> <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">emsList</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">2</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">1</span><span style="color:#66d9ef">Dh</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">4</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tsrLen</span>  <span style="color:#66d9ef">equ</span>     <span style="color:#66d9ef">crtMode</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; DOS Environment Reserved by RI
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; --------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Flag                        &#39;XX&#39;       2 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Environment Segment                    1 word
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Free MCBs                         &lt;=7*10 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;     MCB segment               1 word
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;     MCB                       5 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   End flag                    &#39;MM&#39;       1 word
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   COM LPT ports                        10h bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   LEDs status                            1 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Packed vectors list               &lt;=400h bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Flag                        &#39;CV&#39;       2 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   CVT First DPB pointer                  4 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       DPBs data                     &lt;=5*26 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       First DCB pointer                  4 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       Pointer to NUL                     4 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       All device driver datas     &lt;=30h*10 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Flag                        &#39;XM&#39;       2 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   XMS free handle counter                2 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   EMS free handle list            &lt;=100h*4 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Flag                        &#39;EM&#39;       2 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   EMS free handle counter                2 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   EMS free handle list              &lt;=1024 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       EMS handle              1 word
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       Number of pages         1 word
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Flag                        &#39;--&#39;       1 word
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   Equipment List                         1 word
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   CRT 40:49h-66h                       1dh bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       40:A8h                             1 dword
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;   BIOS User Data Area  40:F0--FF       10h bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; ***************************************************************************
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>main:           <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">main0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Print</span>           <span style="color:#66d9ef">Macro</span>   <span style="color:#66d9ef">Str</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Lea</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">Str</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">DisplayStr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">endm</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">InstMsg</span> <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">RAMinit</span>  <span style="color:#66d9ef">Version</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">.12</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Copyright</span> (<span style="color:#66d9ef">c</span>) <span style="color:#ae81ff">1989</span>-<span style="color:#ae81ff">1994</span>  <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">KingSoft</span> <span style="color:#66d9ef">Ltd.</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Msg0</span>    <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Already</span> <span style="color:#66d9ef">installed</span> !<span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">For</span> <span style="color:#66d9ef">Help</span>, <span style="color:#66d9ef">type</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">RI</span> <span style="color:#960050;background-color:#1e0010">/?&#34;</span>. <span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Msg_0</span>   <span style="color:#66d9ef">db</span>  <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Residents</span> <span style="color:#66d9ef">a</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">RAMinit</span> <span style="color:#66d9ef">copy</span> [<span style="color:#66d9ef">y</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#66d9ef">n</span>] <span style="color:#960050;background-color:#1e0010">?</span> <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Msg_2</span>   <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">OK</span>, <span style="color:#66d9ef">RI</span> <span style="color:#66d9ef">No.</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Msg_RI</span>  <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#66d9ef">residents</span> <span style="color:#66d9ef">successful</span> !<span style="color:#960050;background-color:#1e0010">&#39;</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Msg1</span>    <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Activate</span> <span style="color:#66d9ef">with</span>:  <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">KeyMsg</span>  <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Right_Shift$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Left_Shift$</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">KMsg1</span> <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Left_Ctrl$</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Left_Alt$</span>   <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Right_Ctrl$</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Right_Alt$</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">KMsg2</span> <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Ctrl$</span>       <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Alt$</span>        <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Ctrl$</span>       <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Alt$</span>        <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">PlusMsg</span> <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#960050;background-color:#1e0010">+</span> <span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">crlf</span>    <span style="color:#66d9ef">db</span>  <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">HelpMsg</span> <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Programmed</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">Mr.</span> <span style="color:#66d9ef">Leijun</span>    <span style="color:#66d9ef">Dec</span> <span style="color:#ae81ff">1992</span><span style="color:#960050;background-color:#1e0010">&#39;</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Usage</span>:   <span style="color:#66d9ef">RI</span> [<span style="color:#66d9ef">options</span>]<span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;/</span><span style="color:#66d9ef">H</span>,<span style="color:#960050;background-color:#1e0010">/?</span>    <span style="color:#66d9ef">Display</span> <span style="color:#66d9ef">this</span> <span style="color:#66d9ef">screen</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;/</span><span style="color:#66d9ef">CLS</span>     <span style="color:#66d9ef">Removes</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">TSR</span> <span style="color:#66d9ef">programs</span> <span style="color:#66d9ef">after</span> <span style="color:#66d9ef">current</span> <span style="color:#66d9ef">RI</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;/</span><span style="color:#66d9ef">RET</span>     <span style="color:#66d9ef">Removes</span> <span style="color:#66d9ef">TSR</span> <span style="color:#66d9ef">programs</span> <span style="color:#66d9ef">include</span> <span style="color:#66d9ef">current</span> <span style="color:#66d9ef">RI</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;/</span><span style="color:#66d9ef">NEW</span>     <span style="color:#66d9ef">Residents</span> <span style="color:#66d9ef">a</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">data</span> <span style="color:#66d9ef">copy</span> <span style="color:#66d9ef">of</span> <span style="color:#66d9ef">current</span> <span style="color:#66d9ef">environment</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;/</span><span style="color:#66d9ef">ALL</span>     <span style="color:#66d9ef">Removes</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">RI</span> <span style="color:#66d9ef">copies</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">other</span> <span style="color:#66d9ef">tsr</span> <span style="color:#66d9ef">programs</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;/</span><span style="color:#66d9ef">Sxyy..</span>  <span style="color:#66d9ef">Define</span> <span style="color:#66d9ef">Hotkey</span>   <span style="color:#66d9ef">x</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">AuxHotkey</span>   <span style="color:#66d9ef">yy..</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">shift</span> <span style="color:#66d9ef">status</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#66d9ef">x</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">auxiliary</span> <span style="color:#66d9ef">hotkey</span> (<span style="color:#66d9ef">default</span> <span style="color:#66d9ef">is</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">X</span><span style="color:#960050;background-color:#1e0010">&#34;</span>) <span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>           <span style="color:#66d9ef">x</span> <span style="color:#66d9ef">equ</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#66d9ef">means</span> <span style="color:#66d9ef">need</span> <span style="color:#66d9ef">AuxHotkey</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#66d9ef">yy..</span><span style="color:#960050;background-color:#1e0010">=</span><span style="color:#66d9ef">shift</span> <span style="color:#66d9ef">status</span>  [<span style="color:#66d9ef">CAScas</span>]<span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>           <span style="color:#66d9ef">C</span>: <span style="color:#66d9ef">Left</span> <span style="color:#66d9ef">Ctrl</span>    <span style="color:#66d9ef">A</span>: <span style="color:#66d9ef">Left</span> <span style="color:#66d9ef">Alt</span>    <span style="color:#66d9ef">S</span>: <span style="color:#66d9ef">Left</span> <span style="color:#66d9ef">Shift</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>           <span style="color:#66d9ef">c</span>: <span style="color:#66d9ef">Right</span> <span style="color:#66d9ef">Ctrl</span>   <span style="color:#66d9ef">a</span>: <span style="color:#66d9ef">Right</span> <span style="color:#66d9ef">Alt</span>   <span style="color:#66d9ef">s</span>: <span style="color:#66d9ef">Right</span> <span style="color:#66d9ef">Shift</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Example</span>: <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">RI</span> <span style="color:#960050;background-color:#1e0010">/</span><span style="color:#66d9ef">S1c</span><span style="color:#960050;background-color:#1e0010">&#34;</span>  <span style="color:#66d9ef">means</span> <span style="color:#66d9ef">Hotkey</span> <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">Right_Ctrl</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#66d9ef">X</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">RI</span> <span style="color:#960050;background-color:#1e0010">/</span><span style="color:#66d9ef">S0Cc</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#66d9ef">means</span> <span style="color:#66d9ef">HotKey</span> <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">Left_Ctrl</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#66d9ef">Right_Ctrl</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">RI</span> <span style="color:#960050;background-color:#1e0010">/</span><span style="color:#66d9ef">CLS</span><span style="color:#960050;background-color:#1e0010">&#34;</span>  <span style="color:#66d9ef">equals</span> <span style="color:#66d9ef">simply</span> <span style="color:#66d9ef">press</span> <span style="color:#66d9ef">hotkey</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#66d9ef">RI</span> <span style="color:#960050;background-color:#1e0010">/</span><span style="color:#66d9ef">RET</span><span style="color:#960050;background-color:#1e0010">&#34;</span>  <span style="color:#66d9ef">Removes</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">TSRs</span> <span style="color:#66d9ef">after</span> <span style="color:#66d9ef">current</span> <span style="color:#66d9ef">RI</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">this</span> <span style="color:#66d9ef">RI</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Contact</span> <span style="color:#66d9ef">me</span> <span style="color:#66d9ef">for</span> <span style="color:#66d9ef">RAMinit</span> <span style="color:#66d9ef">problems</span>: (<span style="color:#ae81ff">01</span>)<span style="color:#ae81ff">2561155</span> <span style="color:#66d9ef">Call</span> <span style="color:#ae81ff">1997</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ErrMsg</span>  <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">ERROR</span>: <span style="color:#66d9ef">Invalid</span> <span style="color:#66d9ef">options</span> !<span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">WinErr</span>  <span style="color:#66d9ef">db</span>  <span style="color:#ae81ff">7</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Sorry</span>, <span style="color:#66d9ef">I</span> <span style="color:#66d9ef">cannot</span> <span style="color:#66d9ef">work</span> <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">Windows</span> <span style="color:#66d9ef">DOS</span> <span style="color:#66d9ef">environment.</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">SetMsg</span>  <span style="color:#66d9ef">db</span>  <span style="color:#ae81ff">7</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Defines</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">Hotkey</span> <span style="color:#66d9ef">successful</span> !<span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">tsrOK</span>   <span style="color:#66d9ef">db</span>  <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Main0:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cld</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">instMsg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">IsWinDos</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">WinErr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">c00h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">HotKeyValid</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Status</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">EMS_test</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">CmpDosVer</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">CmpSideKick</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">GetMachineID</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ModifyHotKeyPrompt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">101</span><span style="color:#66d9ef">h</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">IE</span><span style="color:#960050;background-color:#1e0010">&#39;</span>        <span style="color:#75715e">; &#39;LEI&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">CmdLine</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">PrintHotKeyPrompt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrOK</span>, <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">tsrReplyOK</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrOK</span>, <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">PrintCopies</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_2:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:[<span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">EL</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:[<span style="color:#ae81ff">102</span><span style="color:#66d9ef">h</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">I</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">std</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">eof</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">eof</span> - <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">Here</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">tsrLen</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cld</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">tsrLen</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Here:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>,<span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">endTSR</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">DataBegin</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">NextDataSeg</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">XX</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">in</span>      <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a1h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">in</span>      <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">old_8259</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>,<span style="color:#66d9ef">al</span>                  <span style="color:#75715e">; CLI
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SaveOthers</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SetSelfInt</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">BackupVecList</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Power</span>, <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">BackupCVTchain</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">BackupMemoryManager</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@20:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">BackupBiosData</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sti</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Flag</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>    <span style="color:#75715e">; no busy
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">StopFlag</span>, <span style="color:#ae81ff">0</span>  <span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrLength</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SetDosEnvSeg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">29</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cld</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrLength</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">DataBegin</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sub</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">120</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">DataBegin</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrLength</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@29:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>, <span style="color:#66d9ef">al</span>                         <span style="color:#75715e">; STI
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">out</span>     <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a1h</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrLength</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">27</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>SetDosEnvSeg:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>   <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">16</span><span style="color:#66d9ef">h</span>]    <span style="color:#75715e">; Get father process psp segment
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@11:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">2</span><span style="color:#66d9ef">ch</span>] <span style="color:#75715e">; Get father process env segment
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">DosEnv</span>, <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>SaveOthers:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">cs</span>:[<span style="color:#ae81ff">2</span><span style="color:#66d9ef">ch</span>]            <span style="color:#75715e">; Env Seg
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">backupMCB</span>               <span style="color:#75715e">; Current MCB
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>                 <span style="color:#75715e">; COM LPT Port
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>                 <span style="color:#75715e">; LED status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosb</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       call    OpenLEDs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; --------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>backupMCB:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">ZM</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">52</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>                     <span style="color:#75715e">; Get MCB chain head
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx-2</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">0</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Z</span><span style="color:#960050;background-color:#1e0010">&#39;</span>    <span style="color:#75715e">; End ?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">0</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">M</span><span style="color:#960050;background-color:#1e0010">&#39;</span>    <span style="color:#75715e">; Memory control block
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">3</span>], <span style="color:#ae81ff">0</span>      <span style="color:#75715e">; Nul mcb
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>      <span style="color:#75715e">; Free MCB
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SaveFreeMCB</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>   <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@20:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SaveFreeMCB</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a000h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnb</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">9</span><span style="color:#66d9ef">fffh</span>               <span style="color:#75715e">; MS-DOS UMB
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@30:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c000h</span>              <span style="color:#75715e">; 386MAX
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">ja</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">90</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c020h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@90:</span>                                   <span style="color:#75715e">; Error ?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">MM</span><span style="color:#960050;background-color:#1e0010">&#39;</span>                <span style="color:#75715e">; Set MCB flag
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SaveFreeMCB:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">si</span>,<span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               push    ax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               stosw
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               xor     si,si
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               movsb
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               movsw
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               movsw
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               pop     ax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               cmp     ax, 09fffh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               jnb     @@3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               push    ax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               push    ds
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               mov     ds,ax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               cmp     byte ptr ds:[0], &#39;M&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               pop     ds
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               pop     ax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               jnz     @@4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               mov     ax, 09fffh              ; MS-DOS UMB
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               jmp     @@0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;       @@4:    cmp     ax, 0c000h
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               ja      @@3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               mov     ax, 0c020h              ; 386MAX
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;               jmp     @@0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; --------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>OpenLEDs:       <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>                      <span style="color:#75715e">; Open all LEDs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">070</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>], <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">16</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">4</span>                   <span style="color:#75715e">; Delay
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@20:</span>   <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@21:</span>   <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>:[<span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>], <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">16</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; --------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>SetSelfInt:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">self</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">3509</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldInt9_addr</span>,<span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldInt9_addr</span>[<span style="color:#ae81ff">2</span>],<span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>,<span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">NewInt9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">2509</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">352</span><span style="color:#66d9ef">Fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldInt2F_addr</span>,<span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldInt2F_addr</span>[<span style="color:#ae81ff">2</span>],<span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>,<span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">newInt2F</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">252</span><span style="color:#66d9ef">Fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">351</span><span style="color:#66d9ef">Ch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldInt1C_addr</span>,<span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">oldInt1C_addr</span>[<span style="color:#ae81ff">2</span>],<span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>,<span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">newInt1C</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">251</span><span style="color:#66d9ef">ch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cli</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">Copies</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_0:   <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">NextDataSeg</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">NextDataSeg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_1:   <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">NextDataSeg</span>, <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>SaveCounter:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">EL</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">I</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">3</span>], <span style="color:#66d9ef">bl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">di</span>, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>DisplayStr:     <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>CmdLine:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">80</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">dec</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;/&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">S</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">s</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_2:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SetHotKey</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">SetMsg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">c00h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_3:   <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">A</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jb</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Z</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ja</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si-1</span>],<span style="color:#ae81ff">20</span><span style="color:#66d9ef">h</span>  <span style="color:#75715e">; DownCase
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@3:</span>    <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">s</span><span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#75715e">; CLS
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si-3</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">lc</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#66d9ef">Err</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@5:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">h</span><span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#75715e">; HELP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#66d9ef">help</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;?&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#66d9ef">help</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">t</span><span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#75715e">; RET
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si-3</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">er</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@7:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#66d9ef">Err</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@6:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">w</span><span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#75715e">; NEW
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si-3</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">en</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrOK</span>, <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@8:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">l</span><span style="color:#960050;background-color:#1e0010">&#39;</span>         <span style="color:#75715e">; ALL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si-3</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">la</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">c0d7h</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#66d9ef">Err</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@</span>Err:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">ErrMsg</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@</span>help:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">HelpMsg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">c00h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>tsrReplyOK:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">Msg0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_10:  <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">NextDataSeg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_0:   <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">dec</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">0</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">OC</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">Msg_0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">crlf</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">y</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Y</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#75715e">; Print Msg_1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">c01h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@3:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">tsrOK</span>, <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PrintCopies:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>                      <span style="color:#75715e">; Added -by- Mr. Lei
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>             <span style="color:#75715e">; Aug 24, 1993
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">Copies</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">al</span>                      <span style="color:#75715e">; Total RI copies
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>                      <span style="color:#75715e">; Set es = current mcb
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">dec</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">5</span>                   <span style="color:#75715e">; Search end of file name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>   <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span>], <span style="color:#ae81ff">20</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span>], <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ffh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span>], <span style="color:#ae81ff">00</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@20:</span>                                   <span style="color:#75715e">; Set current RI no
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span>], <span style="color:#960050;background-color:#1e0010">&#39;</span>:<span style="color:#960050;background-color:#1e0010">&#39;</span>   <span style="color:#75715e">; &#34;RI:2&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>], <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnb</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">2</span>], <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@30:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Msg_RI</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">Msg_2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">; Backup Interrupt Vector List
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>BackupVecList:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">si</span>,<span style="color:#66d9ef">si</span>                   <span style="color:#75715e">; Vectors
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>,<span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>,<span style="color:#ae81ff">00</span><span style="color:#66d9ef">ffh</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@0:</span>    <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di-2</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di-4</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SaveCounter</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@3:</span>    <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SaveCounter</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@4:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;-----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>BackupCVTchain:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">VC</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">52</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>             <span style="color:#75715e">; ES:BX -- DOS table as described below
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; --------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>              <span style="color:#75715e">; DPB chains
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lds</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">cvtOfs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#66d9ef">bx</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">12</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#66d9ef">bx</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">14</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lds</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#66d9ef">bx</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">18</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">si</span>, -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       mov     ax, 5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">;       mul     cl
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">;       add     ax, 4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">;       add     cs:tsrLength, ax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; --------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>              <span style="color:#75715e">; DCB   file control blocks
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">les</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span><span style="color:#960050;background-color:#1e0010">+</span><span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@11:</span>   <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span>], -<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">les</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xchg</span>    <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       add     cs:tsrLength, 4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; ---------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>              <span style="color:#75715e">; Device Driver Chains
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">22</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">bx</span>          <span style="color:#75715e">; NUL
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cl</span>, <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lds</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">ds</span>:[<span style="color:#66d9ef">si</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>BackupBiosData:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span>--<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ds</span>, <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a8h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">49</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">1</span><span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsb</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">f0h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>BackupMemoryManager:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SaveXMSstatus</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">SaveEMSstatus</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;---------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>SaveEMSstatus:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">status</span>, <span style="color:#66d9ef">EMSbit</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">ME</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">67</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di-2</span>], <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shl</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shl</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; -------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>SaveXMSstatus:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_test</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">status</span>, <span style="color:#66d9ef">XMSbit</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">MX</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_alloc</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>                  <span style="color:#75715e">; XMS alloc failure
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_1:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">sub</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">MaxHandles</span> * <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_Lock</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">bl</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a2h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@3:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_unlock</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@4:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">handle_begin</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_bstat</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cl</span>, <span style="color:#66d9ef">bl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_Free</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Handle_begin</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@5:</span>    <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_Lock</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">bl</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">a2h</span>                <span style="color:#75715e">; Handle invalid
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@6:</span>    <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">XMS_unlock</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@7:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">stosw</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loop</span>    <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">; ------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>XMS_test:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4300</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">80</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4310</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">2</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">XMS_control</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">XMS_control</span>[<span style="color:#ae81ff">2</span>], <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Status</span>, <span style="color:#66d9ef">XMSbit</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>XMS_stat:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">hma_exist</span>, <span style="color:#66d9ef">dl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">hma_exist</span>       <span style="color:#66d9ef">db</span>      <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>XMS_alloc:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>XMS_lock:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>XMS_unlock:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>XMS_bstat:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">eh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>XMS_free:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">dword</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">xms_control</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>EMS_test:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">EMMname</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">d00h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jc</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">eh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Status</span>, <span style="color:#66d9ef">EMSbit</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">EMMname</span>         <span style="color:#66d9ef">db</span>      <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">EMMXXXX0</span><span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>SetHotKey:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">C</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">LeftCtrl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">c</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">RightCtrl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@3:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">A</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">LeftAlt</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@4:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">a</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">RightAlt</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@5:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">S</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">LeftShift</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@6:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">s</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">RightShift</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@7:</span>    <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@</span><span style="color:#66d9ef">Err</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">HotKey</span>, <span style="color:#66d9ef">bl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>, <span style="color:#ae81ff">2</span><span style="color:#66d9ef">dh</span>       <span style="color:#75715e">; &#39;X&#39; scan key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">29</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@29:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">30</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Self</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">HotKey</span>, <span style="color:#66d9ef">bl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bl</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>:<span style="color:#66d9ef">AuxHotKey</span>, <span style="color:#66d9ef">bl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@30:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">GetRunFileName</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">d02h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jc</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">100</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jc</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4200</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">17</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jc</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">AuxHotKey</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jc</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">3</span><span style="color:#66d9ef">eh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; -----------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>GetRunFileName:
</span></span><span style="display:flex;"><span><span style="color:#75715e">; Return:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">;      DS:DX    Pointer of this run file name ASCIIZ string
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">2</span><span style="color:#66d9ef">ch</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">1000</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">@@1:</span>            <span style="color:#a6e22e">repnz</span>   <span style="color:#a6e22e">scasb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">di</span>], <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">loopnz</span>  <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">di</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>GetMachineID:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">KBD102</span>,<span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#ae81ff">40</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">test</span>    <span style="color:#66d9ef">byte</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">96</span><span style="color:#66d9ef">h</span>], <span style="color:#ae81ff">00010000</span><span style="color:#66d9ef">b</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">Kbd102</span>,<span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">dec</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>,<span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>,<span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">0</span><span style="color:#66d9ef">eh</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">MachineID</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ModifyHotKeyPrompt:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Kbd102</span>, <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">es</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cs</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ds</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">12</span>*<span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">KMsg2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">di</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">KMsg1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">rep</span>     <span style="color:#a6e22e">movsb</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@9:</span>    <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">MachineID</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">fch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jna</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">clsStrcolor</span>, <span style="color:#ae81ff">70</span><span style="color:#66d9ef">h</span>     <span style="color:#75715e">; Mono
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">clsStr</span>, <span style="color:#ae81ff">70</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@10:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>PrintHotKeyPrompt:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">Msg1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">HotKey</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">and</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">33</span><span style="color:#66d9ef">ch</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">ah</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">KeyMsg</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@40:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>                          <span style="color:#75715e">; Mr. Lei 4/25/1993
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_42</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">shr</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnc</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">41</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ColorDisplayStr</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       mov     ah, 9
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">;       int     21h
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">42</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">PlusMsg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ColorDisplayStr</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       Print   PlusMsg
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@41:</span>   <span style="color:#a6e22e">add</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@42:</span>   <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_42:  <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">43</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">HotKey</span>, <span style="color:#ae81ff">0</span>                    <span style="color:#75715e">; Mr. Lei
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_43</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">PlusMsg</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ColorDisplayStr</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       Print   PlusMsg
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@</span>_43:  <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">dx</span>, <span style="color:#66d9ef">offset</span> <span style="color:#66d9ef">AuxHotKeyName</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">call</span>    <span style="color:#66d9ef">ColorDisplayStr</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">;       Print   AuxHotKeyName
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#960050;background-color:#1e0010">@@43:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">crlf</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ColorDisplayStr:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">bl</span>, <span style="color:#ae81ff">0</span><span style="color:#66d9ef">fh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">si</span>, <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">bh</span>, <span style="color:#66d9ef">bh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cx</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">lodsb</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">al</span>, <span style="color:#66d9ef">al</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">push</span>    <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">09</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">inc</span>     <span style="color:#66d9ef">dl</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">10</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jmp</span>     <span style="color:#66d9ef">short</span> <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">si</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">dx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">cx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">pop</span>     <span style="color:#66d9ef">bx</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>CmpSideKick:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">xor</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">les</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">20</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx-4</span>], <span style="color:#ae81ff">4</span><span style="color:#66d9ef">b53h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx-2</span>], <span style="color:#ae81ff">4942</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">es</span>, <span style="color:#66d9ef">ax</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">les</span>     <span style="color:#66d9ef">bx</span>, <span style="color:#66d9ef">es</span>:[<span style="color:#ae81ff">94</span><span style="color:#66d9ef">h</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">word</span> <span style="color:#66d9ef">ptr</span> <span style="color:#66d9ef">es</span>:[<span style="color:#66d9ef">bx-2</span>], <span style="color:#ae81ff">4</span><span style="color:#66d9ef">b53h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jz</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">or</span>      <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">Status</span>, <span style="color:#66d9ef">SKbit</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ---------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>CmpDosVer:      <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ah</span>, <span style="color:#ae81ff">30</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jb</span>      <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">al</span>, <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jna</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">cvtOfs</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@2:</span>    <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">cvtOfs</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@1:</span>    <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">DosVerErr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">cffh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">DosVerErr</span> <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Sorry</span>, <span style="color:#66d9ef">DOS</span> <span style="color:#66d9ef">version</span> <span style="color:#66d9ef">too</span> <span style="color:#66d9ef">lower</span> !<span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HotKeyValid:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">HotKey</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">cmp</span>     <span style="color:#66d9ef">cs</span>:<span style="color:#66d9ef">AuxHotKey</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">jnz</span>     <span style="color:#960050;background-color:#1e0010">@@</span><span style="color:#66d9ef">_1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Print</span>   <span style="color:#66d9ef">HotKeyErr</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">mov</span>     <span style="color:#66d9ef">ax</span>, <span style="color:#ae81ff">4</span><span style="color:#66d9ef">cfeh</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">int</span>     <span style="color:#ae81ff">21</span><span style="color:#66d9ef">h</span>
</span></span><span style="display:flex;"><span>        <span style="color:#960050;background-color:#1e0010">@@</span>_1:   <span style="color:#a6e22e">ret</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">HotKeyErr</span> <span style="color:#66d9ef">db</span>  <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">Sorry</span>, <span style="color:#66d9ef">please</span> <span style="color:#66d9ef">setup</span> <span style="color:#66d9ef">hotkey</span> <span style="color:#66d9ef">again.</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">dh</span>,<span style="color:#ae81ff">0</span><span style="color:#66d9ef">ah</span>,<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#66d9ef">$</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>eof:
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ends</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">end</span>     <span style="color:#66d9ef">Start</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">; ------------- The End ! ---------------------------------------------------
</span></span></span></code></pre></div>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">DennisThink</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2019-01-28
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>



    
    


    <footer class="post-footer">
      


      
      <nav class="post-nav">
        
          <a class="prev" href="/post/2020/01/%E5%BF%AB%E4%B9%90%E7%9A%84%E5%B7%A5%E4%BD%9C/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">快乐的工作</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/2020/01/%E7%AB%9E%E4%BA%89%E8%8C%83%E5%9B%B4%E5%92%8C%E8%A1%8C%E4%B8%9A%E5%88%86%E5%B8%83/">
            <span class="next-text nav-default">聊聊为什么二线城市IT公司比较少</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  


  
  

  

  
  

  
  

  

  

    

  

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:dennismi1024@gmail.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>


<a href="https://www.dennisthink.com/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
  
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
    <br>晋ICP备18003008号
  </span>
  <span class="copyright-year">
    &copy;
    
      2017 -
    2023
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        DennisThink
        
      </span></span>
  
  
  
  
</div>


    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.0ad349017808f9c3192b88ad05faf786650358631fca9cd1416cbfa088cdf915.js" integrity="sha256-CtNJAXgI&#43;cMZK4itBfr3hmUDWGMfypzRQWy/oIjN&#43;RU=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  

















</body>
</html>
